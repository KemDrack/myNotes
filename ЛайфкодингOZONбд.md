[[ОстальноеБД]]

[[Задача с книгами]]

Допустим у нас в IT-шная контора и в ней мало женщин в ней. Как построить индекс, чтобы не занимать много места?
```sql
CREATE INDEX ON employee USING btree (sex, name) WHERE sex = 'w';
```

---
#### Вопросы 
1. Какие составные индексы знаешь?
- B-Tree (по нескольким столбцам) Оптимален для запросов, которые **используют первые N столбцов**
- GIN (Generalized Inverted Index) Подходит для **массивов, JSONB и Full-Text Search**:
- GiST Подходит для **геоданных, диапазонов**
- BRIN Эффективен **для больших таблиц с упорядоченными данными**

2. Чем отличаются forwarded и inverted индексы?
**Forwarded Index** - классический индекс (например, B-Tree). 
Ключ → указатель на строку в таблице
**Inverted Index (Обратный индекс)**
- **Ключ → множество строк** (где встречается значение).
- Применяется **для текстового поиска, массивов, JSONB**.

3. Как устроен BRIN?
Индекс, хранящий **диапазоны значений для блоков** данных.
- Разбивает таблицу **на блоки** (по `128 KB`, `256 KB` и т. д.)
- Для каждого блока хранит **минимальное и максимальное значение**
- Идеально **для больших таблиц, где данные упорядочены (например, логи, time-series)**.

4. Какой индекс лучше применить для поиска точного совпадения строки для столбца с массивом строк? Например, поиск точного тэга по массиву тэгов товара
Почему GIN? ✅ Оптимизирован для поиска по массивам.
```sql
CREATE INDEX idx_tags ON products USING GIN(tags);
```