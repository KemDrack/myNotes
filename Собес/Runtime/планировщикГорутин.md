

 Горутины это потоки в пользовательском пространстве (user-space thread). Они создаются и управляются рантаймом языка, а не ОС. Они менее ресурснозатратные, чем потоки ОС (user-space threads менее ресурснозатратные) и управляются они планировщиком горутин

Планировщик использует планирование M:N, где M - системные потоки, а N - горутины, которые выполняются на системных потоках

![[Pasted image 20250114182036.png]]

В примере на картинке выше у нас есть 2 системных потока (OS Threads) и 6 горутин, которые планировщик самостоятельно распределил по системным потокам

Основные элементы:
Верхнеуровнево [[систему планирования M N]] можно описать, используя 3 структуры:

<font color="#9bbb59">M</font>: Системный поток (Физический поток, управляемый ОС)
<font color="#9bbb59">G</font>: Горутина (Лёгковесная задача, управляемая рантаймом)
<font color="#9bbb59">P</font>: Контекст для планировщика(Распределяет задачи между M)

P = M (12 для моего случая)

<font color="#9bbb59">P</font> управляет очередью горутин:
У Go фиксированное число <font color="#9bbb59">P</font>, определяемое значением `GOMAXPROCS` (по умолчанию оно равно числу процессоров в системе).





- Каждая горутина использует часть оперативной памяти для своего стека ([[Стек и Куча]]) и других данных например: [[Инструкций]]
- По сравнению с системными потоками, стек горутины изначально небольшой (обычно около 2 КБ) и может динамически расширяться



