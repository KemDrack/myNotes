#Паттерн
NGINX    ENVOY  KrakenD

**API Gateway** – это **посредник** между клиентами (мобильными приложениями, веб-сайтами, сервисами) и **микросервисами**. Он обеспечивает **единую точку входа** в систему, упрощает маршрутизацию запросов, балансировку нагрузки, аутентификацию и кэширование

В **API Gateway** не нужно супер много что то делать, иначе это может превратиться в монолит, который потом нужно будет распиливать.

![[{D9349730-49EC-434E-ADD1-E88FE9CC38A6}.png]]

Вместо того чтобы клиент знал про все микросервисы, он отправляет **все запросы в одно место**, Gateway знает, какой внутренний сервис отвечает за обработку конкретного запроса, и перенаправляет его туда

**Какие действия и ответственность можно ему дать?**
- **Маршрутизация (Routing):** Основная задача – направить запрос к нужному микросервису
- **Аутентификация и Авторизация:**  проверка JWT-токенов (валидация подписи, срока действия) при помощи Auth Service (Keycloak) – идеальная задача для Gateway. Он может отсекать неаутентифицированные запросы до того, как они достигнут внутренних сервисов. Может выполнять и базовую авторизацию по ролям из токена.
- **Rate Limiting:** Ограничение количества запросов от одного клиента за определенный период времени (защита от злоупотреблений и перегрузки). Часто реализуется с помощью **Redis** для хранения счетчиков
- **Кэширование:** Кэширование ответов на GET-запросы, которые не требуют актуальности в реальном времени (например, списки продуктов, справочники). **Redis** идеально подходит для этого
- Gateway может принимать **HTTPS**-соединения от клиентов, расшифровывать их, а внутри сети общаться с микросервисами по обычному **HTTP** (если внутренняя сеть доверенная), снимая нагрузку SSL с каждого сервиса.
- **Агрегация запросов (Request Aggregation):** Иногда клиенту нужны данные из нескольких сервисов сразу. Gateway может принять один запрос от клиента, сам сходить в несколько внутренних сервисов, собрать ответы и вернуть клиенту единый агрегированный ответ.
- Может изменять запросы перед отправкой сервису или ответы перед отправкой клиенту
- **Логирование и Мониторинг:** Централизованный сбор логов и базовых метрик по всем входящим запросам