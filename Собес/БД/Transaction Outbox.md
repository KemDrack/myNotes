**Когда мы сохраняем данные и асинхронно отправляем** 

**Вместо отправки события напрямую**, мы:
1. Сохраняем событие в специальную таблицу `outbox` в той же транзакции, что и запись в PostgreSQL.
2. Фоновый процесс (`Job`) читает `outbox` и отправляет данные в Kafka / RabbitMQ.
3. Если отправка успешна — удаляем запись из `outbox`.


Есть основная таблица и специальная **outbox**, куда мы складываем допустим Event, что заказ был создан

В коде приложения поднят какой-то воркер(горутина), который периодично ходит в **outbox** таблицу сканирует и отправляет в MQ(Очередь сообщений). При отправке он **удаляет** эту запись

![[{5ED96F9A-355F-4016-9022-AA522DBAADD1}.png]]